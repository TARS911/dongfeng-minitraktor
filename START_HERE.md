# ‚≠ê –ù–ê–ß–ù–ò–¢–ï –û–¢–°–Æ–î–ê - –î–ï–ü–õ–û–ô –ó–ê 15 –ú–ò–ù–£–¢

## üéØ –í–°–Å –ì–û–¢–û–í–û! –í–ê–ú –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨ 3 –®–ê–ì–ê:

---

## üìù –®–ê–ì 1: SQL –ú–ò–ì–†–ê–¶–ò–ò (5 –º–∏–Ω—É—Ç)

### –û—Ç–∫—Ä–æ–π—Ç–µ Supabase:
```
https://supabase.com/dashboard
```

### –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç ‚Üí SQL Editor

### –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–∂–¥—É—é):

#### –ú–∏–≥—Ä–∞—Ü–∏—è 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑: docs/migrations/fix-equipment-category.sql
-- –ò–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä—è–º–æ –æ—Ç—Å—é–¥–∞:

UPDATE categories 
SET 
  name = '–ö–æ–º–º—É–Ω–∞–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞',
  description = '–°–Ω–µ–≥–æ—É–±–æ—Ä—â–∏–∫–∏, –≥–∞–∑–æ–Ω–æ–∫–æ—Å–∏–ª–∫–∏, –ø–æ–¥–º–µ—Ç–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã, —Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è —É–±–æ—Ä–∫–∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π',
  updated_at = NOW()
WHERE slug = 'equipment';

-- –ü—Ä–æ–≤–µ—Ä–∫–∞:
SELECT id, name, slug, description FROM categories WHERE slug = 'equipment';
```

#### –ú–∏–≥—Ä–∞—Ü–∏—è 2: Audit Trail
```sql
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –∫–æ–¥ –∏–∑: docs/migrations/audit-trail.sql
-- –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É audit_log –∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

#### –ú–∏–≥—Ä–∞—Ü–∏—è 3: RLS –ü–æ–ª–∏—Ç–∏–∫–∏
```sql
-- –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
DROP POLICY IF EXISTS "Allow public insert on categories" ON categories;
CREATE POLICY "Allow public insert on categories"
  ON categories FOR INSERT WITH CHECK (true);

DROP POLICY IF EXISTS "Allow public update on categories" ON categories;
CREATE POLICY "Allow public update on categories"
  ON categories FOR UPDATE USING (true);

DROP POLICY IF EXISTS "Allow public delete on categories" ON categories;
CREATE POLICY "Allow public delete on categories"
  ON categories FOR DELETE USING (true);

-- –†–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
DROP POLICY IF EXISTS "Allow public insert on products" ON products;
CREATE POLICY "Allow public insert on products"
  ON products FOR INSERT WITH CHECK (true);

DROP POLICY IF EXISTS "Allow public update on products" ON products;
CREATE POLICY "Allow public update on products"
  ON products FOR UPDATE USING (true);
```

‚úÖ **–®–ê–ì 1 –ì–û–¢–û–í!**

---

## üöÄ –®–ê–ì 2: –î–ï–ü–õ–û–ô (3 –º–∏–Ω—É—Ç—ã)

### –í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å GitHub ‚Üí Netlify –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)

Netlify —É–∂–µ –¥–µ–ø–ª–æ–∏—Ç –≤–∞—à –∫–æ–¥! –ü—Ä–æ—Å—Ç–æ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ: https://app.netlify.com
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à —Å–∞–π—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∫–ª–∞–¥–∫—É "Deploys"
4. –î–æ–∂–¥–∏—Ç–µ—Å—å "Published" (~3-5 –º–∏–Ω—É—Ç)

**–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (–µ—Å–ª–∏ –µ—â—ë –Ω–µ—Ç):
- Site settings ‚Üí Environment variables ‚Üí Add variable:
  - `NEXT_PUBLIC_SUPABASE_URL` = –≤–∞—à URL –∏–∑ Supabase
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY` = –≤–∞—à anon key

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

```bash
cd /home/ibm/dongfeng-minitraktor
./deploy.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ –°–æ–±–µ—Ä—ë—Ç –ø—Ä–æ–µ–∫—Ç (npm run build)
- ‚úÖ –ó–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–∞ Netlify

–í–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Netlify –∫–æ–≥–¥–∞ –ø–æ–ø—Ä–æ—Å–∏—Ç.

‚úÖ **–®–ê–ì 2 –ì–û–¢–û–í!**

---

## üß™ –®–ê–ì 3: –ü–†–û–í–ï–†–ö–ê (2 –º–∏–Ω—É—Ç—ã)

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–∞–π—Ç
```
https://–≤–∞—à-—Å–∞–π—Ç.netlify.app
```
–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
```
https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/admin/categories
```
–î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.

**–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é:**
- –ù–∞–∂–º–∏—Ç–µ "+ –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"
- –ù–∞–∑–≤–∞–Ω–∏–µ: `–¢–µ—Å—Ç`
- Slug: `test`
- –û–ø–∏—Å–∞–Ω–∏–µ: `–¢–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è`
- –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å"

–ï—Å–ª–∏ —Å–æ–∑–¥–∞–ª–∞—Å—å - **–≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!** ‚úÖ

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API
```bash
curl https://–≤–∞—à-—Å–∞–π—Ç.netlify.app/api/categories
```
–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å JSON —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏.

‚úÖ **–®–ê–ì 3 –ì–û–¢–û–í!**

---

## üéâ –ì–û–¢–û–í–û! –í–ê–® –°–ê–ô–¢ –í PRODUCTION!

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:

#### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:
- `/admin/categories` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

#### API:
- `GET /api/categories` - —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `POST /api/categories` - —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- `GET/PUT/DELETE /api/categories/:id` - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- `GET /api/products?page=1&search=...&sort=price_asc` - —Ç–æ–≤–∞—Ä—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- `POST /api/import/products` - –º–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç (–¥–æ 1000 —Ç–æ–≤–∞—Ä–æ–≤)
- `POST /api/import/bitrix` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å 1–°-–ë–∏—Ç—Ä–∏–∫—Å

#### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- ‚úÖ Rate Limiting (100 req/min)
- ‚úÖ Security Headers (A+ rating)
- ‚úÖ Input Validation
- ‚úÖ SQL Injection –∑–∞—â–∏—Ç–∞

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
- ‚úÖ Audit Trail - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `audit_log`

---

## üìñ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

### –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–µ—Ç–∞–ª–∏:
- `DEPLOY_INSTRUCTIONS.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–µ–ø–ª–æ—è
- `IMPLEMENTATION_REPORT.md` - –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –æ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- `QUICK_DEPLOY.md` - –±—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π
- `docs/migrations/apply-migrations.md` - –¥–µ—Ç–∞–ª–∏ SQL –º–∏–≥—Ä–∞—Ü–∏–π

### –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å:
- –°–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª "TROUBLESHOOTING" –≤ `DEPLOY_INSTRUCTIONS.md`

---

## ‚è±Ô∏è –í–†–ï–ú–Ø –í–´–ü–û–õ–ù–ï–ù–ò–Ø

| –®–∞–≥ | –í—Ä–µ–º—è |
|-----|-------|
| SQL –º–∏–≥—Ä–∞—Ü–∏–∏ | 5 –º–∏–Ω |
| –î–µ–ø–ª–æ–π | 3-5 –º–∏–Ω |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ | 2 –º–∏–Ω |
| **–ò–¢–û–ì–û** | **~15 –º–∏–Ω—É—Ç** |

---

## ‚úÖ –ë–´–°–¢–†–´–ô –ß–ï–ö–õ–ò–°–¢

```
‚òê –û—Ç–∫—Ä—ã–ª Supabase Dashboard
‚òê –í—ã–ø–æ–ª–Ω–∏–ª –º–∏–≥—Ä–∞—Ü–∏—é fix-equipment-category
‚òê –í—ã–ø–æ–ª–Ω–∏–ª –º–∏–≥—Ä–∞—Ü–∏—é audit-trail
‚òê –ù–∞—Å—Ç—Ä–æ–∏–ª RLS –ø–æ–ª–∏—Ç–∏–∫–∏
‚òê –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å
‚òê –û—Ç–∫—Ä—ã–ª Netlify Dashboard (–∏–ª–∏ –∑–∞–ø—É—Å—Ç–∏–ª ./deploy.sh)
‚òê –î–æ–∂–¥–∞–ª—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –¥–µ–ø–ª–æ—è
‚òê –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Å–∞–π—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
‚òê –ü—Ä–æ–≤–µ—Ä–∏–ª /admin/categories
‚òê –°–æ–∑–¥–∞–ª —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
‚òê –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ API —Ä–∞–±–æ—Ç–∞–µ—Ç
```

–ï—Å–ª–∏ –≤—Å–µ –≥–∞–ª–æ—á–∫–∏ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω—ã - **–í–´ –ú–û–õ–û–î–¶–´!** üöÄ

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–ª—è production:
–ó–∞–º–µ–Ω–∏—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–µ RLS –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```sql
-- –í –±—É–¥—É—â–µ–º –∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞:
CREATE POLICY "Admin only write categories"
  ON categories FOR ALL
  USING (auth.jwt()->>'role' = 'admin');
```

### –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
- –ò–ª–∏ bulk import: `POST /api/import/products`

### –ù–∞—Å—Ç—Ä–æ–π—Ç–µ 1–° –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:
- –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: `GET /api/import/bitrix`

---

**–ì–æ—Ç–æ–≤–æ! –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –≤–∞—à–∏–º production-ready —Å–∞–π—Ç–æ–º!** ‚ú®
