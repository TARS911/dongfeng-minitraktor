<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ - DONGFENG –ú–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–∞</title>
        <meta
            name="description"
            content="–ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã - –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–∞ DONGFENG"
        />

        <link rel="stylesheet" href="css/variables.css?v=1761211422" />
        <link rel="stylesheet" href="css/reset.css?v=1761211422" />
        <link rel="stylesheet" href="css/components.css?v=1761211422" />
        <link rel="stylesheet" href="css/effects.css?v=1761211422" />
        <link rel="stylesheet" href="css/main.css?v=1761211422" />
        <link rel="stylesheet" href="css/modal.css?v=1761211422" />
        <link rel="stylesheet" href="css/header-new.css?v=1761211422" />
        <link rel="stylesheet" href="css/modern-header.css?v=1761991144" />
        <link rel="stylesheet" href="css/promo-blocks.css?v=1761211422" />
        <link rel="stylesheet" href="css/mobile-menu.css?v=1761211422" />
        <link rel="stylesheet" href="css/cart-buttons-fix.css?v=1761995152" />
        <link rel="stylesheet" href="css/vertical-menu.css" />
        <link rel="stylesheet" href="css/mobile-improvements.css" />
        <link rel="stylesheet" href="css/catalog-modals.css?v=1761211422" />
        <link rel="stylesheet" href="css/cart.css?v=1761211422" />
        <link rel="stylesheet" href="css/cart-header-mobile.css?v=1761211422" />
        <link rel="stylesheet" href="css/footer-minimal.css?v=1761211422" />
    </head>
    <body class="with-sidebar">
                    <!-- Left Section: Logo + City + Catalog -->
                    <div class="modern-header__left">
                        <a href="index.html" class="modern-header__logo"
                            >DONGFENG</a
                        >

                        <!-- City Selector -->
                        <div class="city-selector-modern">
                            <button
                                class="city-selector-modern__btn"
                                onclick="toggleCitySelector()"
                            >
                                <svg
                                    width="16"
                                    height="16"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                >
                                    <path
                                        d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
                                    />
                                    <circle cx="12" cy="10" r="3" />
                                </svg>
                                <span id="selectedCity">–ë–µ–ª–≥–æ—Ä–æ–¥</span>
                                <svg
                                    width="12"
                                    height="12"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                >
                                    <polyline points="6 9 12 15 18 9" />
                                </svg>
                            </button>
                            <div
                                class="city-selector-modern__dropdown"
                                id="cityDropdown"
                            >
                                <div class="city-selector-modern__title">
                                    –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –≥–æ—Ä–æ–¥:
                                </div>
                                <ul class="city-selector-modern__list">
                                    <li onclick="selectCity('–ë–µ–ª–≥–æ—Ä–æ–¥')">
                                        –ë–µ–ª–≥–æ—Ä–æ–¥
                                    </li>
                                    <li onclick="selectCity('–ö—É—Ä—Å–∫')">–ö—É—Ä—Å–∫</li>
                                    <li onclick="selectCity('–í–æ—Ä–æ–Ω–µ–∂')">
                                        –í–æ—Ä–æ–Ω–µ–∂
                                    </li>
                                    <li onclick="selectCity('–û—Ä—ë–ª')">–û—Ä—ë–ª</li>
                                    <li onclick="selectCity('–¢—É–ª–∞')">–¢—É–ª–∞</li>
                                    <li onclick="selectCity('–õ–∏–ø–µ—Ü–∫')">
                                        –õ–∏–ø–µ—Ü–∫
                                    </li>
                                    <li onclick="selectCity('–ë—Ä—è–Ω—Å–∫')">
                                        –ë—Ä—è–Ω—Å–∫
                                    </li>
                                </ul>
                            </div>
                        </div>

                        <!-- Catalog Button -->
                        <a href="catalog.html" class="catalog-btn-modern">
                            <svg
                                width="20"
                                height="20"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <line x1="3" y1="12" x2="21" y2="12"></line>
                                <line x1="3" y1="6" x2="21" y2="6"></line>
                                <line x1="3" y1="18" x2="21" y2="18"></line>
                            </svg>
                            –ö–ê–¢–ê–õ–û–ì
                        </a>
                    </div>

                    <!-- Center Section: Navigation -->
                    <div class="modern-header__nav">
                        <ul class="nav-menu-modern">
                            <li><a href="index.html">–ì–õ–ê–í–ù–ê–Ø</a></li>
                            <li><a href="payment.html">–û–ü–õ–ê–¢–ê</a></li>
                            <li><a href="delivery.html">–î–û–°–¢–ê–í–ö–ê</a></li>
                            <li><a href="warranty.html">–ì–ê–†–ê–ù–¢–ò–Ø</a></li>
                            <li><a href="articles.html">–°–¢–ê–¢–¨–ò</a></li>
                            <li><a href="contacts.html">–ö–û–ù–¢–ê–ö–¢–´</a></li>
                            <li><a href="media.html">–ú–ï–î–ò–ê</a></li>
                        </ul>
                    </div>

                    <!-- Right Section: Icons -->
                    <div class="modern-header__actions">
                        <!-- Sidebar Toggle (Desktop only) -->
                        <button class="sidebar-desktop-toggle" onclick="toggleSidebarDesktop()" title="–°–≤–µ—Ä–Ω—É—Ç—å/—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º–µ–Ω—é">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect x="3" y="3" width="7" height="7"></rect>
                                <rect x="14" y="3" width="7" height="7"></rect>
                                <rect x="14" y="14" width="7" height="7"></rect>
                                <rect x="3" y="14" width="7" height="7"></rect>
                            </svg>
                        </button>

                        <!-- Compare -->
                        <a href="compare.html" class="action-btn">
                            <svg
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                            >
                                <line x1="8" y1="6" x2="8" y2="18" />
                                <line x1="16" y1="6" x2="16" y2="18" />
                            </svg>
                            <span class="action-btn__text">–°—Ä–∞–≤–Ω–µ–Ω–∏–µ</span>
                            <span
                                class="action-btn__badge"
                                id="compareCount"
                                style="display: none"
                                >0</span
                            >
                        </a>

                        <!-- Favorites -->
                        <a href="favorites.html" class="action-btn">
                            <svg
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
                                />
                            </svg>
                            <span class="action-btn__text">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                            <span
                                class="action-btn__badge"
                                id="favoritesCount"
                                style="display: none"
                                >0</span
                            >
                        </a>

                        <!-- Cart -->
                        <a href="cart.html" class="action-btn action-btn--cart">
                            <svg
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="white"
                                stroke-width="2"
                            >
                                <circle cx="12" cy="12" r="11" fill="#2a9d4e" />
                                <path
                                    d="M8 9L6 11H18L16 9H8Z"
                                    stroke="white"
                                    stroke-width="1.5"
                                />
                                <path
                                    d="M6 11H18L17 17H7L6 11Z"
                                    stroke="white"
                                    stroke-width="1.5"
                                />
                            </svg>
                            <span class="action-btn__text">–ö–æ—Ä–∑–∏–Ω–∞</span>
                            <span
                                class="action-btn__badge"
                                id="cartCount"
                                style="display: none"
                                >0</span
                            >
                        </a>

                        <!-- Auth Button -->
                        <button
                            class="action-btn action-btn--auth"
                            onclick="handleAuth()"
                        >
                            <svg
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                            >
                                <path
                                    d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"
                                />
                                <circle cx="12" cy="7" r="4" />
                            </svg>
                            <span class="action-btn__text">–í–æ–π—Ç–∏</span>
                        </button>
                    </div>

                    <!-- Mobile Menu Toggle -->
                    <button
                        class="mobile-menu-toggle"
                        onclick="toggleMobileMenu()"
                        aria-label="–ú–µ–Ω—é"
                    >
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu__header">
                <a href="index.html"
                    ><img
                        src="images/logo.svg"
                        alt="DONGFENG"
                        class="mobile-menu__logo"
                /></a>
                <button
                    class="mobile-menu__close"
                    onclick="closeMobileMenu()"
                    aria-label="–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é"
                >
                    √ó
                </button>
            </div>
            <nav class="mobile-menu__nav">
                <ul class="mobile-menu__list">
                    <li class="mobile-menu__item">
                        <a
                            href="catalog.html"
                            class="mobile-menu__link mobile-menu__link--catalog"
                            ><span>üöú –ö–∞—Ç–∞–ª–æ–≥ —Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="index.html" class="mobile-menu__link"
                            ><span>–ì–ª–∞–≤–Ω–∞—è</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="payment.html" class="mobile-menu__link"
                            ><span>–û–ø–ª–∞—Ç–∞</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="delivery.html" class="mobile-menu__link"
                            ><span>–î–æ—Å—Ç–∞–≤–∫–∞</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="warranty.html" class="mobile-menu__link"
                            ><span>–ì–∞—Ä–∞–Ω—Ç–∏—è</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="articles.html" class="mobile-menu__link"
                            ><span>–°—Ç–∞—Ç—å–∏</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="contacts.html" class="mobile-menu__link"
                            ><span>–ö–æ–Ω—Ç–∞–∫—Ç—ã</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="media.html" class="mobile-menu__link"
                            ><span>–ú–µ–¥–∏–∞</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="favorites.html" class="mobile-menu__link"
                            ><span>‚ù§Ô∏è –ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span></a
                        >
                    </li>
                    <li class="mobile-menu__item">
                        <a href="compare.html" class="mobile-menu__link"
                            ><span>‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ</span></a
                        >
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <main class="main" style="padding-top: 40px; min-height: 80vh">
            <div class="container" style="max-width: 1400px">
                <!-- Breadcrumbs -->
                <nav
                    style="margin-bottom: 24px; font-size: 14px; color: #737373"
                >
                    <a
                        href="index.html"
                        style="color: #737373; text-decoration: none"
                        >–ì–ª–∞–≤–Ω–∞—è</a
                    >
                    <span style="margin: 0 8px">/</span>
                    <span style="color: #171717">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                </nav>

                <div
                    style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 32px;
                        flex-wrap: wrap;
                        gap: 16px;
                    "
                >
                    <h1
                        style="
                            font-size: 42px;
                            margin: 0;
                            color: #171717;
                            font-weight: 700;
                        "
                    >
                        –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
                    </h1>

                    <a
                        href="catalog.html"
                        class="btn btn--outline"
                        style="
                            text-decoration: none;
                            display: inline-flex;
                            align-items: center;
                            gap: 8px;
                        "
                    >
                        <svg
                            width="16"
                            height="16"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <polyline points="15 18 9 12 15 6"></polyline>
                        </svg>
                        –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥
                    </a>
                </div>

                <div id="favoritesContainer"></div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer-minimal">
            <div class="footer-minimal__container">
                <div class="footer-minimal__left">
                    <p class="footer-minimal__text">
                        ¬© 2024 DONGFENG. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–∏–ª–µ—Ä –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤.
                    </p>
                </div>
                <div class="footer-minimal__right">
                    <a href="terms.html" class="footer-minimal__link"
                        >–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ</a
                    >
                    <a href="privacy.html" class="footer-minimal__link"
                        >–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a
                    >
                </div>
            </div>
        </footer>

        <script>
            const API_URL =
                window.location.hostname === "localhost"
                    ? "http://localhost:3000"
                    : "https://dongfeng-minitraktor-production.up.railway.app";
            window.API_URL = API_URL;
        </script>
        <script src="js/app.js"></script>
        <script src="js/catalog-filters.js"></script>
        <script src="js/catalog.js"></script>
        <script src="js/cart.js"></script>
        <script src="js/vertical-menu.js"></script>
        <script src="js/modern-header.js"></script>
        <script src="js/header-icons-animation.js"></script>

        <script>
            // Render Favorites Page
            async function renderFavoritesPage() {
                const container = document.getElementById("favoritesContainer");
                const favorites = JSON.parse(
                    localStorage.getItem("favorites") || "[]",
                );

                if (favorites.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px;">
                            <h3 style="font-size: 28px; margin-bottom: 16px; color: #404040;">–°–ø–∏—Å–æ–∫ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—É—Å—Ç</h3>
                            <p style="font-size: 18px; color: #737373;">–î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è —Ç–æ–≤–∞—Ä—ã –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</p>
                        </div>
                    `;
                    return;
                }

                try {
                    const response = await fetch(
                        `${window.API_URL}/api/products`,
                    );
                    const data = await response.json();

                    if (data.success && data.data) {
                        const favoriteProducts = data.data.filter((p) =>
                            favorites.includes(p.id),
                        );

                        const html = `
                            <div class="favorites-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px; margin-top: 40px;">
                                ${favoriteProducts
                                    .map(
                                        (product) => `
                                    <div class="product-card-favorite" style="background: white; border-radius: 12px; padding: 20px; border: 1px solid #e8e8e8; transition: all 0.3s;">
                                        <img src="${product.image_url}" alt="${product.name}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 16px;">
                                        <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 12px; color: #171717;">${product.name}</h3>
                                        <div style="display: flex; gap: 12px; margin-bottom: 12px; font-size: 14px; color: #737373;">
                                            <span>‚ö° ${product.power} –ª.—Å.</span>
                                            <span>üöó ${product.drive}</span>
                                        </div>
                                        <div style="font-size: 24px; font-weight: 700; color: #2a9d4e; margin-bottom: 16px;">
                                            ${product.price.toLocaleString("ru-RU")} ‚ÇΩ
                                        </div>
                                        <div style="display: flex; gap: 12px;">
                                            <button onclick="addToCartFromFavorites(${product.id})" class="btn btn--primary" style="flex: 1;">
                                                –í –∫–æ—Ä–∑–∏–Ω—É
                                            </button>
                                            <button onclick="removeFavorite(${product.id})" class="btn btn--outline" style="width: 48px; padding: 0;">
                                                √ó
                                            </button>
                                        </div>
                                    </div>
                                `,
                                    )
                                    .join("")}
                            </div>
                        `;

                        container.innerHTML = html;
                    }
                } catch (error) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ:", error);
                    container.innerHTML = `
                        <div style="text-align: center; padding: 60px 20px;">
                            <p style="color: #ef4444; font-size: 18px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤</p>
                            <button onclick="location.reload()" class="btn btn--primary" style="margin-top: 20px;">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
                        </div>
                    `;
                }
            }

            function removeFavorite(productId) {
                console.log("removeFavorite called with:", productId);

                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ü–ï–†–ï–î —É–¥–∞–ª–µ–Ω–∏–µ–º
                if (!confirm("–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ?")) {
                    return; // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª —É–¥–∞–ª–µ–Ω–∏–µ
                }

                if (typeof window.toggleFavorite === "function") {
                    window.toggleFavorite(productId);
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –≤ header
                    if (typeof window.updateFavoritesCounter === "function") {
                        window.updateFavoritesCounter();
                    }
                    // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É
                    setTimeout(() => renderFavoritesPage(), 100);
                } else {
                    console.error("toggleFavorite function not found");
                    alert(
                        "–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.",
                    );
                }
            }

            function addToCartFromFavorites(productId) {
                console.log("addToCartFromFavorites called with:", productId);
                if (typeof window.addToCart === "function") {
                    window.addToCart(productId);
                } else {
                    console.error("addToCart function not found");
                    alert(
                        "–§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.",
                    );
                }
            }

            // –í—ã–∑–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.addEventListener("DOMContentLoaded", () => {
                console.log("DOM loaded, rendering favorites page...");
                renderFavoritesPage();
            });
        </script>
    </body>
</html>
