<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - DONGFENG –ú–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–∞</title>
        <meta
            name="description"
            content="–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ DONGFENG"
        />

        <link rel="stylesheet" href="css/variables.css?v=1761211422" />
        <link rel="stylesheet" href="css/reset.css?v=1761211422" />
        <link rel="stylesheet" href="css/components.css?v=1761211422" />
        <link rel="stylesheet" href="css/effects.css?v=1761211422" />
        <link rel="stylesheet" href="css/main.css?v=1761211422" />
        <link rel="stylesheet" href="css/modal.css?v=1761211422" />
        <link rel="stylesheet" href="css/header-new.css?v=1761211422" />
        <link rel="stylesheet" href="css/catalog-modals.css?v=1761211422" />
        <link rel="stylesheet" href="css/cart.css?v=1761211422" />
        <style>
            .checkout-page {
                padding: var(--space-xl) 0;
                background: #fafafa;
                min-height: 100vh;
            }

            .checkout-content {
                display: grid;
                grid-template-columns: 1fr 400px;
                gap: var(--space-xl);
                margin-top: var(--space-xl);
            }

            .checkout-form {
                background: white;
                padding: var(--space-xl);
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            }

            .form-section {
                margin-bottom: var(--space-xl);
            }

            .form-section:last-child {
                margin-bottom: 0;
            }

            .form-section-title {
                font-size: 18px;
                font-weight: 600;
                margin-bottom: var(--space-md);
                color: var(--color-text-primary);
                border-bottom: 2px solid #f0f0f0;
                padding-bottom: var(--space-md);
            }

            .form-group {
                margin-bottom: var(--space-md);
            }

            .form-group:last-child {
                margin-bottom: 0;
            }

            label {
                display: block;
                margin-bottom: 8px;
                font-size: 14px;
                font-weight: 500;
                color: var(--color-text-primary);
            }

            .form-group input,
            .form-group textarea {
                width: 100%;
                padding: 12px;
                border: 1px solid #e0e0e0;
                border-radius: 8px;
                font-size: 14px;
                font-family: inherit;
                transition: border-color 0.2s;
            }

            .form-group input:focus,
            .form-group textarea:focus {
                outline: none;
                border-color: var(--brand-primary);
                box-shadow: 0 0 0 3px rgba(42, 157, 78, 0.1);
            }

            .form-group textarea {
                resize: vertical;
                min-height: 100px;
            }

            .required::after {
                content: " *";
                color: #e74c3c;
            }

            .checkout-summary {
                background: white;
                padding: var(--space-xl);
                border-radius: 12px;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
                position: sticky;
                top: var(--space-lg);
            }

            .summary-title {
                font-size: 18px;
                font-weight: 600;
                margin-bottom: var(--space-lg);
                color: var(--color-text-primary);
            }

            .summary-item {
                display: flex;
                gap: var(--space-md);
                margin-bottom: var(--space-lg);
                padding-bottom: var(--space-lg);
                border-bottom: 1px solid #f0f0f0;
            }

            .summary-item:last-of-type {
                border-bottom: none;
                margin-bottom: 0;
                padding-bottom: 0;
            }

            .summary-item__image {
                width: 80px;
                height: 80px;
                object-fit: cover;
                border-radius: 8px;
                flex-shrink: 0;
            }

            .summary-item__info {
                flex: 1;
                min-width: 0;
            }

            .summary-item__name {
                font-weight: 500;
                font-size: 14px;
                margin-bottom: 4px;
                color: var(--color-text-primary);
            }

            .summary-item__specs {
                font-size: 12px;
                color: var(--color-text-secondary);
                margin-bottom: 4px;
            }

            .summary-item__qty {
                font-size: 12px;
                color: var(--color-text-secondary);
            }

            .summary-totals {
                padding: var(--space-md) 0;
                border-top: 2px solid #f0f0f0;
                border-bottom: 2px solid #f0f0f0;
                margin: var(--space-lg) 0;
            }

            .summary-row {
                display: flex;
                justify-content: space-between;
                margin-bottom: 12px;
                font-size: 14px;
            }

            .summary-row:last-child {
                margin-bottom: 0;
            }

            .summary-row.total {
                font-weight: 600;
                font-size: 16px;
                color: var(--brand-primary);
                margin-top: 12px;
            }

            .checkout-actions {
                display: flex;
                flex-direction: column;
                gap: var(--space-md);
                margin-top: var(--space-lg);
            }

            .btn--submit {
                background: var(--brand-primary);
                color: white;
                border: none;
                padding: 14px 24px;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.2s;
                width: 100%;
            }

            .btn--submit:hover {
                background: #238a3d;
            }

            .btn--submit:disabled {
                background: #ccc;
                cursor: not-allowed;
            }

            .btn--back {
                background: #f0f0f0;
                color: var(--color-text-primary);
                border: none;
                padding: 12px 20px;
                border-radius: 8px;
                font-size: 14px;
                font-weight: 500;
                cursor: pointer;
                transition: background 0.2s;
                text-align: center;
                text-decoration: none;
                display: block;
            }

            .btn--back:hover {
                background: #e0e0e0;
            }

            .error-message {
                background: #fee;
                color: #c33;
                padding: 12px;
                border-radius: 8px;
                margin-bottom: var(--space-md);
                font-size: 14px;
                display: none;
            }

            .success-message {
                background: #efe;
                color: #2a9d4e;
                padding: 12px;
                border-radius: 8px;
                margin-bottom: var(--space-md);
                font-size: 14px;
                display: none;
            }

            .loading {
                display: none;
                text-align: center;
                padding: var(--space-lg);
            }

            .spinner {
                border: 3px solid #f0f0f0;
                border-top: 3px solid var(--brand-primary);
                border-radius: 50%;
                width: 30px;
                height: 30px;
                animation: spin 1s linear infinite;
                margin: 0 auto var(--space-md);
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            @media (max-width: 768px) {
                .checkout-content {
                    grid-template-columns: 1fr;
                }

                .checkout-summary {
                    position: static;
                }
            }
        </style>
    </head>
    <body class="light-theme">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header__content">
                    <div class="logo">
                        <a href="index.html" style="text-decoration: none; color: #2a9d4e; font-size: 20px; font-weight: 600;">
                            DONGFENG
                        </a>
                    </div>

                    <nav class="nav">
                        <ul class="nav__list">
                            <li>
                                <a href="index.html" class="nav__link"
                                    >–ì–ª–∞–≤–Ω–∞—è</a
                                >
                            </li>
                            <li>
                                <a href="payment.html" class="nav__link"
                                    >–û–ø–ª–∞—Ç–∞</a
                                >
                            </li>
                            <li>
                                <a href="delivery.html" class="nav__link"
                                    >–î–æ—Å—Ç–∞–≤–∫–∞</a
                                >
                            </li>
                            <li>
                                <a href="warranty.html" class="nav__link"
                                    >–ì–∞—Ä–∞–Ω—Ç–∏—è</a
                                >
                            </li>
                            <li>
                                <a href="articles.html" class="nav__link"
                                    >–°—Ç–∞—Ç—å–∏</a
                                >
                            </li>
                            <li>
                                <a href="contacts.html" class="nav__link"
                                    >–ö–æ–Ω—Ç–∞–∫—Ç—ã</a
                                >
                            </li>
                            <li>
                                <a href="media.html" class="nav__link">–ú–µ–¥–∏–∞</a>
                            </li>
                        </ul>
                    </nav>

                    <div class="header__contacts">
                        <a href="tel:+79699995668" class="phone"
                            >+7 (969) 999-56-68</a
                        >
                        <a href="cart.html" class="cart-icon">
                            üõí –ö–æ—Ä–∑–∏–Ω–∞
                            <span class="cart-count" id="cartCount">0</span>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <!-- Checkout Page -->
        <section class="checkout-page">
            <div class="container">
                <h1 class="section-title">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h1>

                <div class="checkout-content">
                    <!-- Checkout Form -->
                    <form id="checkoutForm" class="checkout-form">
                        <div id="errorMessage" class="error-message"></div>
                        <div id="successMessage" class="success-message"></div>

                        <!-- Customer Info -->
                        <div class="form-section">
                            <h2 class="form-section-title">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>

                            <div class="form-group">
                                <label for="customer_name" class="required">–ò–º—è</label>
                                <input
                                    type="text"
                                    id="customer_name"
                                    name="customer_name"
                                    required
                                    minlength="2"
                                    maxlength="100"
                                    placeholder="–í–∞—à–µ –ø–æ–ª–Ω–æ–µ –∏–º—è"
                                />
                            </div>

                            <div class="form-group">
                                <label for="customer_phone" class="required">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                <input
                                    type="tel"
                                    id="customer_phone"
                                    name="customer_phone"
                                    required
                                    placeholder="+7 (999) 999-99-99"
                                />
                            </div>

                            <div class="form-group">
                                <label for="customer_email">Email</label>
                                <input
                                    type="email"
                                    id="customer_email"
                                    name="customer_email"
                                    placeholder="your@email.com"
                                />
                            </div>
                        </div>

                        <!-- Delivery Info -->
                        <div class="form-section">
                            <h2 class="form-section-title">–î–æ—Å—Ç–∞–≤–∫–∞</h2>

                            <div class="form-group">
                                <label for="delivery_city" class="required">–ì–æ—Ä–æ–¥</label>
                                <input
                                    type="text"
                                    id="delivery_city"
                                    name="delivery_city"
                                    required
                                    minlength="2"
                                    maxlength="100"
                                    placeholder="–ú–æ—Å–∫–≤–∞"
                                />
                            </div>

                            <div class="form-group">
                                <label for="delivery_address">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</label>
                                <input
                                    type="text"
                                    id="delivery_address"
                                    name="delivery_address"
                                    maxlength="500"
                                    placeholder="–£–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞"
                                />
                            </div>
                        </div>

                        <!-- Notes -->
                        <div class="form-section">
                            <h2 class="form-section-title">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h2>

                            <div class="form-group">
                                <label for="notes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É</label>
                                <textarea
                                    id="notes"
                                    name="notes"
                                    maxlength="1000"
                                    placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤ –≤—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å, —Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –ø—Ä–∏–µ–∑–¥–∞..."
                                ></textarea>
                            </div>
                        </div>

                        <!-- Actions -->
                        <div class="checkout-actions">
                            <button type="submit" class="btn--submit" id="submitBtn">
                                –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑
                            </button>
                            <a href="cart.html" class="btn--back">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É</a>
                        </div>
                    </form>

                    <!-- Order Summary -->
                    <div class="checkout-summary">
                        <h3 class="summary-title">–í–∞—à –∑–∞–∫–∞–∑</h3>

                        <div id="summaryItems"></div>

                        <div class="summary-totals">
                            <div class="summary-row">
                                <span>–¢–æ–≤–∞—Ä–æ–≤:</span>
                                <span id="summaryItemsCount">0</span>
                            </div>
                            <div class="summary-row total">
                                <span>–ò—Ç–æ–≥–æ:</span>
                                <span id="summaryTotal">0 ‚ÇΩ</span>
                            </div>
                        </div>

                        <p style="font-size: 12px; color: var(--color-text-secondary); text-align: center; margin: var(--space-md) 0;">
                            –î–æ—Å—Ç–∞–≤–∫–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏ —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
                        </p>
                    </div>
                </div>
            </div>
        </section>
    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>–ë–ï–õ–¢–ï–•–§–ï–†–ú</h3>
            <p>
              –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–∏–ª–µ—Ä –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ –≤ –†–æ—Å—Å–∏–∏. –ü–æ—Å—Ç–∞–≤–ª—è–µ–º
              –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—É—é —Å–µ–ª—å—Ö–æ–∑—Ç–µ—Ö–Ω–∏–∫—É —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π –∏ –ø–æ–ª–Ω—ã–º —Å–µ—Ä–≤–∏—Å–Ω—ã–º
              –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ–º.
            </p>
            <div class="terra-social-links">
              <a href="#" class="terra-social-link" title="VK">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M15.07 2H8.93C3.33 2 2 3.33 2 8.93v6.14C2 20.67 3.33 22 8.93 22h6.14c5.6 0 6.93-1.33 6.93-6.93V8.93C22 3.33 20.67 2 15.07 2zm3.45 14.41h-1.32c-.57 0-.74-.46-1.76-1.48-.89-.89-1.28-1.01-1.5-1.01-.31 0-.4.09-.4.52v1.34c0 .36-.11.58-1.07.58-1.59 0-3.35-.96-4.59-2.75-1.86-2.67-2.37-4.68-2.37-5.09 0-.22.09-.43.52-.43h1.32c.39 0 .54.18.69.6.74 2.14 1.98 4.01 2.49 4.01.19 0 .28-.09.28-.58v-2.25c-.06-.99-.58-1.08-.58-1.43 0-.18.15-.36.39-.36h2.07c.33 0 .45.18.45.57v3.05c0 .33.15.45.24.45.19 0 .35-.12.7-.47 1.07-1.2 1.84-3.06 1.84-3.06.1-.21.28-.43.72-.43h1.32c.47 0 .57.24.47.57-.17.81-1.94 3.49-1.94 3.49-.16.26-.22.38 0 .68.16.22.69.68 1.04 1.09.64.75 1.13 1.38 1.26 1.81.13.44-.07.66-.51.66z"
                  />
                </svg>
              </a>
              <a href="#" class="terra-social-link" title="Telegram">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.4-.36-.01-1.04-.2-1.55-.37-.63-.2-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"
                  />
                </svg>
              </a>
              <a href="#" class="terra-social-link" title="WhatsApp">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"
                  />
                </svg>
              </a>
              <a href="#" class="terra-social-link" title="YouTube">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"
                  />
                </svg>
              </a>
            </div>
          </div>
          
          <div class="footer-section">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <ul>
              <li><a href="about.html">–û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
              <li><a href="delivery.html">–î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</a></li>
              <li><a href="warranty.html">–ì–∞—Ä–∞–Ω—Ç–∏—è –∏ —Å–µ—Ä–≤–∏—Å</a></li>
              <li><a href="media.html">–§–æ—Ç–æ –∏ –≤–∏–¥–µ–æ</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
            <ul>
              <li><a href="tel:+79699995668">üìû +7 (969) 999-56-68</a></li>
              <li>
                <a href="mailto:info@beltehferm.ru">üìß info@beltehferm.ru</a>
              </li>
              <li><a href="contacts.html">üìç –ë–µ–ª–≥–æ—Ä–æ–¥, –ö—É—Ä—Å–∫, –ë—Ä—è–Ω—Å–∫</a></li>
            </ul>
            <p style="margin-top: 1.5rem; font-size: 0.875rem">
              –ü–Ω-–ü—Ç: 9:00 - 18:00<br />–°–±-–í—Å: –ü–æ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
            </p>
          </div>
        </div>
        <div class="footer-bottom">
          ¬© 2025 –ë–ï–õ–¢–ï–•–§–ï–†–ú - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–∏–ª–µ—Ä –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤. –í—Å–µ
          –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
        </div>
      </div>
    </footer>

        <script src="js/config.js"></script>
        <script src="js/global-cart.js"></script>
        <script>
            // Initialize page
            document.addEventListener("DOMContentLoaded", () => {
                if (typeof cart === 'undefined' || cart.length === 0) {
                    window.location.href = '/cart.html';
                    return;
                }

                updateCartCounter();
                renderOrderSummary();
                setupFormHandler();
            });

            // Update cart counter in header
            function updateCartCounter() {
                const cartCount = document.getElementById("cartCount");
                if (cartCount && typeof cart !== 'undefined') {
                    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
                    cartCount.textContent = totalItems;
                }
            }

            // Render order summary
            function renderOrderSummary() {
                const container = document.getElementById("summaryItems");
                const itemsCountEl = document.getElementById("summaryItemsCount");
                const totalEl = document.getElementById("summaryTotal");

                let totalPrice = 0;
                let totalItems = 0;

                const itemsHTML = cart.map(item => {
                    const subtotal = item.product.price * item.quantity;
                    totalPrice += subtotal;
                    totalItems += item.quantity;

                    return `
                        <div class="summary-item">
                            <img src="${item.product.image_url}" alt="${item.product.name}" class="summary-item__image">
                            <div class="summary-item__info">
                                <div class="summary-item__name">${item.product.name}</div>
                                <div class="summary-item__specs">${item.product.power} –ª.—Å. ‚Ä¢ ${item.product.drive}</div>
                                <div class="summary-item__qty">–ö–æ–ª-–≤–æ: ${item.quantity}</div>
                                <div class="summary-item__qty">${subtotal.toLocaleString('ru-RU')} ‚ÇΩ</div>
                            </div>
                        </div>
                    `;
                }).join('');

                container.innerHTML = itemsHTML;
                itemsCountEl.textContent = totalItems;
                totalEl.textContent = totalPrice.toLocaleString('ru-RU') + ' ‚ÇΩ';
            }

            // Setup form handler
            function setupFormHandler() {
                const form = document.getElementById("checkoutForm");
                const submitBtn = document.getElementById("submitBtn");

                form.addEventListener("submit", async (e) => {
                    e.preventDefault();

                    // Validate form
                    if (!form.checkValidity()) {
                        showError("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è");
                        return;
                    }

                    // Disable submit button
                    submitBtn.disabled = true;
                    submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∫–∞...";

                    try {
                        // Prepare order data
                        const orderData = {
                            customer_name: document.getElementById("customer_name").value,
                            customer_phone: document.getElementById("customer_phone").value,
                            customer_email: document.getElementById("customer_email").value || null,
                            delivery_city: document.getElementById("delivery_city").value,
                            delivery_address: document.getElementById("delivery_address").value || null,
                            notes: document.getElementById("notes").value || null,
                            items: cart.map(item => ({
                                product_id: item.id,
                                quantity: item.quantity
                            }))
                        };

                        // Submit order
                        const response = await fetch(`${window.API_URL}/api/orders`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(orderData)
                        });

                        const data = await response.json();

                        if (data.success) {
                            // Clear cart
                            localStorage.removeItem('cart');

                            // Show success message
                            showSuccess(data.message || "–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!");

                            // Redirect to order confirmation
                            setTimeout(() => {
                                if (data.data && data.data.order_number) {
                                    window.location.href = `/order-confirmation.html?number=${data.data.order_number}`;
                                } else {
                                    window.location.href = '/';
                                }
                            }, 2000);
                        } else {
                            showError(data.error || "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞");
                            submitBtn.disabled = false;
                            submitBtn.textContent = "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑";
                        }
                    } catch (error) {
                        console.error("Checkout error:", error);
                        showError("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–∫–∞–∑–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.");
                        submitBtn.disabled = false;
                        submitBtn.textContent = "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑";
                    }
                });
            }

            // Show error message
            function showError(message) {
                const errorEl = document.getElementById("errorMessage");
                const successEl = document.getElementById("successMessage");
                errorEl.textContent = message;
                errorEl.style.display = "block";
                successEl.style.display = "none";
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }

            // Show success message
            function showSuccess(message) {
                const successEl = document.getElementById("successMessage");
                const errorEl = document.getElementById("errorMessage");
                successEl.textContent = message;
                successEl.style.display = "block";
                errorEl.style.display = "none";
            }
        </script>
    </body>
</html>
