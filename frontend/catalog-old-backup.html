<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      –ö–∞—Ç–∞–ª–æ–≥ –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ DONGFENG - –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–∏–ª–µ—Ä –≤ –†–æ—Å—Å–∏–∏ | –¶–µ–Ω—ã –æ—Ç
      –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è
    </title>
    <meta
      name="description"
      content="–ö–∞—Ç–∞–ª–æ–≥ –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ DONGFENG. –ö–∏—Ç–∞–π—Å–∫–∏–µ –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π –ø–æ –†–§ –∏ –°–ù–ì. –ì–∞—Ä–∞–Ω—Ç–∏—è 1 –≥–æ–¥, —Å–µ—Ä–≤–∏—Å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ, –∑–∞–ø—á–∞—Å—Ç–∏ –≤ –Ω–∞–ª–∏—á–∏–∏. –¶–µ–Ω—ã –æ—Ç 285 000 —Ä—É–±."
    />

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/png"
      href="https://res.cloudinary.com/drenz1aia/image/upload/v1760698083/dongfeng-minitraktor/favicon.svg"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="/css/unified-style.css" />

    <style>
      /* –§–∏–ª—å—Ç—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–∞ */
      .catalog-filters {
        background: white;
        padding: 30px;
        border-radius: 12px;
        margin-bottom: 30px;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      }

      .filters-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 20px;
        color: #333;
      }

      .filters-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 20px;
      }

      .filter-group {
        display: flex;
        flex-direction: column;
      }

      .filter-label {
        font-weight: 600;
        margin-bottom: 8px;
        color: #333;
        font-size: 14px;
      }

      .filter-select {
        padding: 10px 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 14px;
        transition: border-color 0.3s;
      }

      .filter-select:focus {
        outline: none;
        border-color: #2a9d4e;
      }

      .filter-buttons {
        display: flex;
        gap: 15px;
        margin-top: 10px;
      }

      .catalog-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 15px;
      }

      .catalog-count {
        font-size: 18px;
        color: #666;
      }

      .sort-select {
        padding: 10px 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 14px;
      }

      .no-products {
        text-align: center;
        padding: 60px 20px;
        color: #666;
      }

      .no-products-icon {
        font-size: 64px;
        margin-bottom: 20px;
      }

      /* –ó–∞–≥—Ä—É–∑–∫–∞ */
      .loading {
        text-align: center;
        padding: 60px 20px;
        font-size: 18px;
        color: #666;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-top">
        <div class="container">
          <div class="header-top-content">
            <div>üìç –ë–µ–ª–≥–æ—Ä–æ–¥, –ö—É—Ä—Å–∫, –ë—Ä—è–Ω—Å–∫, –õ–∏–ø–µ—Ü–∫</div>
            <div class="header-contacts">
              <a href="mailto:info@dongfeng-rf.ru">üìß info@dongfeng-rf.ru</a>
            </div>
          </div>
        </div>
      </div>

      <div class="header-main">
        <div class="container">
          <div class="header-content">
            <a href="index.html" class="logo">DONGFENG</a>

            <div class="search-bar">
              <form class="search-form" id="searchForm">
                <input
                  type="text"
                  class="search-input"
                  placeholder="–ü–æ–∏—Å–∫ —Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤..."
                  id="searchInput"
                />
                <button type="submit" class="search-btn">üîç –ù–∞–π—Ç–∏</button>
              </form>
            </div>

            <div class="header-actions">
              <a href="tel:+79699995668" class="header-phone"
                >üìû +7 (969) 999-56-68</a
              >
              <a href="cart.html" class="cart-btn"
                >üõí –ö–æ—Ä–∑–∏–Ω–∞ <span id="cartCount">(0)</span></a
              >
            </div>
          </div>
        </div>
      </div>

      <nav class="nav">
        <div class="container">
          <ul class="nav-list">
            <li><a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
            <li><a href="catalog.html" class="nav-link active">–ö–∞—Ç–∞–ª–æ–≥</a></li>
            <li><a href="about.html" class="nav-link">–û –∫–æ–º–ø–∞–Ω–∏–∏</a></li>
            <li><a href="delivery.html" class="nav-link">–î–æ—Å—Ç–∞–≤–∫–∞</a></li>
            <li><a href="warranty.html" class="nav-link">–ì–∞—Ä–∞–Ω—Ç–∏—è</a></li>
            <li><a href="payment.html" class="nav-link">–û–ø–ª–∞—Ç–∞</a></li>
            <li><a href="contacts.html" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Page Header -->
    <div class="page-header">
      <div class="container">
        <h1 class="page-title">–ö–∞—Ç–∞–ª–æ–≥ –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ DONGFENG</h1>
        <p class="page-subtitle">–ù–∞–¥–µ–∂–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞</p>
      </div>
    </div>

    <!-- Main Content -->
    <main class="page-content">
      <div class="container">
        <!-- –§–∏–ª—å—Ç—Ä—ã -->
        <div class="catalog-filters">
          <h2 class="filters-title">–§–∏–ª—å—Ç—Ä—ã</h2>
          <div class="filters-grid">
            <div class="filter-group">
              <label class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
              <select class="filter-select" id="categoryFilter">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="20-30">20-30 –ª.—Å.</option>
                <option value="30-40">30-40 –ª.—Å.</option>
                <option value="40+">40+ –ª.—Å.</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">–¶–µ–Ω–∞</label>
              <select class="filter-select" id="priceFilter">
                <option value="">–õ—é–±–∞—è —Ü–µ–Ω–∞</option>
                <option value="0-300000">–î–æ 300 000 ‚ÇΩ</option>
                <option value="300000-400000">300 000 - 400 000 ‚ÇΩ</option>
                <option value="400000-999999">–û—Ç 400 000 ‚ÇΩ</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">–ü—Ä–∏–≤–æ–¥</label>
              <select class="filter-select" id="driveFilter">
                <option value="">–õ—é–±–æ–π –ø—Ä–∏–≤–æ–¥</option>
                <option value="4WD">–ü–æ–ª–Ω—ã–π –ø—Ä–∏–≤–æ–¥ (4WD)</option>
                <option value="2WD">–ó–∞–¥–Ω–∏–π –ø—Ä–∏–≤–æ–¥ (2WD)</option>
              </select>
            </div>

            <div class="filter-group">
              <label class="filter-label">–ù–∞–ª–∏—á–∏–µ</label>
              <select class="filter-select" id="stockFilter">
                <option value="">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
                <option value="true">–í –Ω–∞–ª–∏—á–∏–∏</option>
                <option value="false">–ü–æ–¥ –∑–∞–∫–∞–∑</option>
              </select>
            </div>
          </div>

          <div class="filter-buttons">
            <button class="btn btn-primary" id="applyFilters">
              –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
            </button>
            <button class="btn btn-outline" id="resetFilters">–°–±—Ä–æ—Å–∏—Ç—å</button>
          </div>
        </div>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞ -->
        <div class="catalog-header">
          <div class="catalog-count">
            –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: <strong id="productCount">0</strong>
          </div>
          <select class="sort-select" id="sortSelect">
            <option value="newest">–°–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ</option>
            <option value="price_asc">–¶–µ–Ω–∞: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="price_desc">–¶–µ–Ω–∞: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
            <option value="power_asc">–ú–æ—â–Ω–æ—Å—Ç—å: –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
            <option value="power_desc">–ú–æ—â–Ω–æ—Å—Ç—å: –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
          </select>
        </div>

        <!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
        <div class="loading" id="loading">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞...</div>

        <!-- –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div
          class="products-grid"
          id="productsGrid"
          style="display: none"
        ></div>

        <!-- –ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="no-products" id="noProducts" style="display: none">
          <div class="no-products-icon">üì¶</div>
          <h3>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
          <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</p>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>DONGFENG</h3>
            <p>–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–∏–ª–µ—Ä –º–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–æ–≤ DONGFENG –≤ –†–æ—Å—Å–∏–∏</p>
            <p style="margin-top: 15px">
              –ù–∞–¥–µ–∂–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –≤–∞—à–µ–≥–æ —Ö–æ–∑—è–π—Å—Ç–≤–∞
            </p>
          </div>

          <div class="footer-section">
            <h3>–ö–∞—Ç–∞–ª–æ–≥</h3>
            <a href="catalog.html" class="footer-link">–í—Å–µ –º–æ–¥–µ–ª–∏</a>
            <a href="catalog.html?category=20-30" class="footer-link"
              >20-30 –ª.—Å.</a
            >
            <a href="catalog.html?category=30-40" class="footer-link"
              >30-40 –ª.—Å.</a
            >
            <a href="catalog.html?category=40+" class="footer-link">40+ –ª.—Å.</a>
          </div>

          <div class="footer-section">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <a href="about.html" class="footer-link">–û –∫–æ–º–ø–∞–Ω–∏–∏</a>
            <a href="delivery.html" class="footer-link">–î–æ—Å—Ç–∞–≤–∫–∞</a>
            <a href="warranty.html" class="footer-link">–ì–∞—Ä–∞–Ω—Ç–∏—è</a>
            <a href="payment.html" class="footer-link">–û–ø–ª–∞—Ç–∞</a>
          </div>

          <div class="footer-section">
            <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
            <a href="tel:+79699995668" class="footer-link"
              >üìû +7 (969) 999-56-68</a
            >
            <a href="mailto:info@dongfeng-rf.ru" class="footer-link"
              >üìß info@dongfeng-rf.ru</a
            >
            <a href="contacts.html" class="footer-link">üìç –ù–∞—à–∏ –∞–¥—Ä–µ—Å–∞</a>
          </div>
        </div>

        <div class="footer-bottom">
          ¬© 2025 DONGFENG –ú–∏–Ω–∏—Ç—Ä–∞–∫—Ç–æ—Ä–∞. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
        </div>
      </div>
    </footer>

    <!-- JavaScript -->
    <script>
      // API URL
      const API_URL = "https://dongfeng-backend-production.up.railway.app/api";

      // –°–æ—Å—Ç–æ—è–Ω–∏–µ
      let allProducts = [];
      let filteredProducts = [];

      // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
      async function loadProducts() {
        try {
          const response = await fetch(`${API_URL}/products`);
          const data = await response.json();

          if (data.success) {
            allProducts = data.data;
            applyFilters();
          } else {
            showError();
          }
        } catch (error) {
          console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", error);
          showError();
        }
      }

      // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
      function applyFilters() {
        const category = document.getElementById("categoryFilter").value;
        const price = document.getElementById("priceFilter").value;
        const drive = document.getElementById("driveFilter").value;
        const stock = document.getElementById("stockFilter").value;
        const sort = document.getElementById("sortSelect").value;
        const search = document
          .getElementById("searchInput")
          .value.toLowerCase();

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è
        filteredProducts = allProducts.filter((product) => {
          // –ö–∞—Ç–µ–≥–æ—Ä–∏—è
          if (category) {
            const power = product.power;
            if (category === "20-30" && (power < 20 || power > 30))
              return false;
            if (category === "30-40" && (power < 30 || power > 40))
              return false;
            if (category === "40+" && power < 40) return false;
          }

          // –¶–µ–Ω–∞
          if (price) {
            const [min, max] = price.split("-").map(Number);
            if (product.price < min || (max && product.price > max))
              return false;
          }

          // –ü—Ä–∏–≤–æ–¥
          if (drive && product.drive !== drive) return false;

          // –ù–∞–ª–∏—á–∏–µ
          if (stock && product.in_stock.toString() !== stock) return false;

          // –ü–æ–∏—Å–∫
          if (search && !product.name.toLowerCase().includes(search))
            return false;

          return true;
        });

        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞
        filteredProducts.sort((a, b) => {
          switch (sort) {
            case "price_asc":
              return a.price - b.price;
            case "price_desc":
              return b.price - a.price;
            case "power_asc":
              return a.power - b.power;
            case "power_desc":
              return b.power - a.power;
            case "newest":
              return b.id - a.id;
            default:
              return 0;
          }
        });

        renderProducts();
      }

      // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
      function renderProducts() {
        const grid = document.getElementById("productsGrid");
        const loading = document.getElementById("loading");
        const noProducts = document.getElementById("noProducts");
        const countEl = document.getElementById("productCount");

        loading.style.display = "none";
        countEl.textContent = filteredProducts.length;

        if (filteredProducts.length === 0) {
          grid.style.display = "none";
          noProducts.style.display = "block";
          return;
        }

        noProducts.style.display = "none";
        grid.style.display = "grid";

        grid.innerHTML = filteredProducts
          .map(
            (product) => `
                <div class="product-card">
                    <img src="${product.image_url}" alt="${product.name}" class="product-image">
                    <div class="product-content">
                        ${product.is_hit ? '<span class="product-badge">–•–ò–¢ –ü–†–û–î–ê–ñ</span>' : ""}
                        ${product.is_new ? '<span class="product-badge new">–ù–û–í–ò–ù–ö–ê</span>' : ""}
                        <h3 class="product-title">${product.name}</h3>
                        <div class="product-desc">
                            ${product.power} –ª.—Å. ‚Ä¢ ${product.drive} ‚Ä¢ ${product.transmission}
                        </div>
                        <div class="product-price">${product.price.toLocaleString("ru-RU")} ‚ÇΩ</div>
                        ${
                          product.in_stock
                            ? '<span style="color: #2a9d4e; font-weight: 600;">‚úì –í –Ω–∞–ª–∏—á–∏–∏</span>'
                            : '<span style="color: #999;">–ü–æ–¥ –∑–∞–∫–∞–∑</span>'
                        }
                        <a href="product.html?slug=${product.slug}" class="btn btn-primary" style="margin-top: 15px; width: 100%; text-align: center;">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    </div>
                </div>
            `,
          )
          .join("");
      }

      // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
      function showError() {
        document.getElementById("loading").innerHTML =
          "‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";
      }

      // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
      document
        .getElementById("applyFilters")
        .addEventListener("click", applyFilters);
      document.getElementById("resetFilters").addEventListener("click", () => {
        document.getElementById("categoryFilter").value = "";
        document.getElementById("priceFilter").value = "";
        document.getElementById("driveFilter").value = "";
        document.getElementById("stockFilter").value = "";
        document.getElementById("searchInput").value = "";
        applyFilters();
      });
      document
        .getElementById("sortSelect")
        .addEventListener("change", applyFilters);
      document.getElementById("searchForm").addEventListener("submit", (e) => {
        e.preventDefault();
        applyFilters();
      });

      // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
      function updateCartCount() {
        const cart = JSON.parse(localStorage.getItem("cart") || "[]");
        const count = cart.reduce((sum, item) => sum + item.quantity, 0);
        document.getElementById("cartCount").textContent = `(${count})`;
      }

      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
      loadProducts();
      updateCartCount();
    </script>
  </body>
</html>
