# üîÑ –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ü–µ–Ω TATA-AGRO

## –ü—Ä–æ–±–ª–µ–º–∞
–í –ë–î Supabase –µ—Å—Ç—å **286 —Ç–æ–≤–∞—Ä–æ–≤** —Å —Å–∞–π—Ç–∞ tata-agro.
–ò—Ö —Ü–µ–Ω—ã –≤ **–≥—Ä–∏–≤–Ω–∞—Ö (UAH)**, –Ω—É–∂–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ **—Ä—É–±–ª–∏ (RUB)**.

**–ö—É—Ä—Å:** 1 UAH = 1.85 RUB

---

## ‚ö° –ë–´–°–¢–†–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Supabase SQL Editor
```
https://supabase.com/dashboard/project/dpsykseeqloturowdyzf/sql
```

### –®–∞–≥ 2: –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `CONVERT-TATA-PRICES.sql`
–û–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞: `/home/ibm/dongfeng-minitraktor/CONVERT-TATA-PRICES.sql`

### –®–∞–≥ 3: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å SQL –∫–æ–¥ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä

### –®–∞–≥ 4: –í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:

#### 4.1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –®–ê–ì 1 (–ø—Ä–æ–≤–µ—Ä–∫–∞ –î–û)
```sql
SELECT
    '–î–û –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò (UAH - –≥—Ä–∏–≤–Ω—ã)' as status,
    COUNT(*) as total_products,
    MIN(price) as min_price_uah,
    MAX(price) as max_price_uah,
    ROUND(AVG(price), 2) as avg_price_uah
FROM products
WHERE image_url LIKE '%tata-agro%'
  AND price IS NOT NULL
  AND price > 0;
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤: **286**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: **~13 –≥—Ä–Ω**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: **~13,355 –≥—Ä–Ω**
- –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: **~1,175 –≥—Ä–Ω**

---

#### 4.2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ UPDATE (–®–ê–ì 2)

**–†–ê–°–ö–û–ú–ú–ï–ù–¢–ò–†–£–ô–¢–ï** –±–ª–æ–∫ UPDATE (—É–±–µ—Ä–∏—Ç–µ `/*` –∏ `*/`):

```sql
UPDATE products
SET
    price = ROUND(price * 1.85, 2),
    old_price = CASE
        WHEN old_price IS NOT NULL AND old_price > 0
        THEN ROUND(old_price * 1.85, 2)
        ELSE old_price
    END,
    updated_at = NOW()
WHERE image_url LIKE '%tata-agro%'
  AND price IS NOT NULL
  AND price > 0;
```

–ù–∞–∂–º–∏—Ç–µ **Run** (–∏–ª–∏ Ctrl+Enter)

–†–µ–∑—É–ª—å—Ç–∞—Ç: `UPDATE 286` (–æ–±–Ω–æ–≤–ª–µ–Ω–æ 286 —Å—Ç—Ä–æ–∫)

---

#### 4.3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–®–ê–ì 3)
```sql
SELECT
    '–ü–û–°–õ–ï –ö–û–ù–í–ï–†–¢–ê–¶–ò–ò (RUB - —Ä—É–±–ª–∏)' as status,
    COUNT(*) as total_products,
    MIN(price) as min_price_rub,
    MAX(price) as max_price_rub,
    ROUND(AVG(price), 2) as avg_price_rub
FROM products
WHERE image_url LIKE '%tata-agro%'
  AND price IS NOT NULL
  AND price > 0;
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤: **286** ‚úÖ
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: **~24 —Ä—É–±** (–±—ã–ª–æ 13 –≥—Ä–Ω)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞: **~24,707 —Ä—É–±** (–±—ã–ª–æ 13,355 –≥—Ä–Ω)
- –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: **~2,174 —Ä—É–±** (–±—ã–ª–æ 1,175 –≥—Ä–Ω)

---

## ‚úÖ –ì–û–¢–û–í–û!

–í—Å–µ **286 —Ç–æ–≤–∞—Ä–æ–≤** tata-agro —Ç–µ–ø–µ—Ä—å —Å —Ü–µ–Ω–∞–º–∏ –≤ **—Ä—É–±–ª—è—Ö**.

---

## üìä –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

| –¢–æ–≤–∞—Ä | –ë—ã–ª–æ (UAH) | –°—Ç–∞–ª–æ (RUB) |
|-------|------------|-------------|
| –ó–∞–≥–ª—É—à–∫–∞ –≤–æ–¥—è–Ω–æ–π —Ä—É–±–∞—à–∫–∏ | 22 –≥—Ä–Ω | 41 —Ä—É–± |
| –ö–∞—á–∞–ª–∫–∞ –≤—ã—Ç–µ—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è TŒõTŒõ | 42 –≥—Ä–Ω | 78 —Ä—É–± |
| –ü–æ–ª TŒõTŒõ –Ω–∞ –º–æ—Ç–æ—Ç—Ä–∞–∫—Ç–æ—Ä | 421 –≥—Ä–Ω | 779 —Ä—É–± |
| –ü–æ–¥—ä–µ–º–Ω–∏–∫ –≤ —Å–±–æ—Ä–µ TŒõTŒõ | 13,355 –≥—Ä–Ω | 24,707 —Ä—É–± |

---

## üîç –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –û—à–∏–±–∫–∞: "relation does not exist"
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –û—à–∏–±–∫–∞: "permission denied"
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **service_role** –∫–ª—é—á, –∞ –Ω–µ anon –∫–ª—é—á

### –ù—É–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```sql
-- –ù–ï –î–ï–õ–ê–ô–¢–ï –≠–¢–û, –µ—Å–ª–∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ!
UPDATE products
SET price = ROUND(price / 1.85, 2)
WHERE image_url LIKE '%tata-agro%';
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

–ü–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ü–µ–Ω –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **–ó–ê–î–ê–ß–ï 2**:
- –ò–º–ø–æ—Ä—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö **1,772 —Ç–æ–≤–∞—Ä–æ–≤** –∏–∑ CSV —Ñ–∞–π–ª–æ–≤ tata-agro
